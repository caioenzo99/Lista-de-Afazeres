{% extends 'base.html.twig' %}

{% block title %}Lista de Tarefas{% endblock %}

{% block body %}
<h1>Lista de Tarefas</h1>

<a href="{{ path('app_task_new') }}">â• Nova Tarefa</a>

<table border="1" cellpadding="5">
    <tr>
        <th>TÃ­tulo</th>
        <th>Status</th>
        <th>AÃ§Ãµes</th>
    </tr>
    {% for task in tasks %}
<table>
    <thead>
        <tr>
            <td>{{ task.title }}</td>
            <td>{{ task.status ? 'âœ… ConcluÃ­da' : 'âŒ› Pendente' }}</td>
            <td>
                <a href="{{ path('app_task_edit', {id: task.id}) }}">âœï¸ Editar</a>
                <form method="post" action="{{ path('app_task_delete', {id: task.id}) }}" style="display:inline;" onsubmit="return confirm('Tem certeza?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ task.id) }}">
                    <button type="submit">ğŸ—‘ï¸ Excluir</button>
                </form>
            </td>
            <th>TÃ­tulo</th>
            <th>Data da Tarefa</th>
            <th>Status</th>
            <th>DescriÃ§Ã£o</th>
            <th>AÃ§Ãµes</th>
        </tr>
    {% else %}
        <tr>
            <td colspan="4">Nenhuma tarefa encontrada.</td>
        </tr>
    {% endfor %}
    </thead>
    <tbody>
        {% for task in tasks %}
            <tr>
                <td>{{ task.title }}</td>
                <td>
                    {{ task.deadline|date('d/m/Y') }}
                    {% if task.deadline < "now"|date %}
                    {% endif %}
                </td>
                <td>{{ task.status ? 'ConcluÃ­da' : 'Pendente' }}</td>
                <td>{{ task.description }}</td>
                <td>
                    <a href="{{ path('app_task_show', {'id': task.id}) }}">Ver</a>
                    <a href="{{ path('app_task_edit', {'id': task.id}) }}">Editar</a>
                    <form method="post" action="{{ path('app_task_delete', {'id': task.id}) }}" 
                        onsubmit="return confirm('Deseja realmente excluir esta tarefa?');" 
                        class="delete-form">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ task.id) }}">
                        <button type="submit">Excluir</button>
                    </form>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="9">Nenhuma tarefa encontrada</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}